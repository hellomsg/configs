
plugins {
    id 'com.github.johnrengelman.shadow' version '2.0.1' apply true
}

apply plugin: 'java'

group = 'com.hellomsg'
version = '1.0'

description = """main"""

sourceCompatibility = 1.8
targetCompatibility = 1.8
tasks.withType(JavaCompile) {
    options.encoding = 'UTF-8'
}

def loadConfiguration() {
    def environment = hasProperty('env')?env:'prod'
    def configFile = file('config.groovy')
    return new ConfigSlurper(environment).parse(configFile.toURI().toURL())
}

processResources {
    from(sourceSets.main.resources.srcDirs) {
        include '**/*.properties'
        expand loadConfiguration()
    }
    from(sourceSets.main.resources.srcDirs) {
        exclude '**/*.properties'
    }
}

jar {
    manifest {
        attributes 'Main-Class': 'com.hellomsg.Main'
    }
}

shadowJar {

}

dependencies {
    compile group: 'junit', name: 'junit', version:'3.8.1'
}
